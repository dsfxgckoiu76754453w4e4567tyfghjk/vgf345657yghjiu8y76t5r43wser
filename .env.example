# ============================================================================
# Environment (4 isolated: local, dev, stage, prod)
# ============================================================================
ENVIRONMENT=local
APP_NAME=Shia Islamic Chatbot
APP_VERSION=1.0.0
DEBUG=true
API_HOST=0.0.0.0
API_PORT=8000

# ============================================================================
# Database (PostgreSQL)
# ============================================================================
DATABASE_HOST=localhost
DATABASE_PORT=5433
DATABASE_USER=postgres
DATABASE_PASSWORD=postgres
DATABASE_NAME=shia_chatbot_local
DATABASE_DRIVER=postgresql+asyncpg
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_READ_REPLICA_ENABLED=false
DATABASE_READ_REPLICA_HOST=
DATABASE_READ_REPLICA_PORT=

# ============================================================================
# Redis (Single DB per environment: local=0, dev=1, stage=2, prod=3)
# ============================================================================
REDIS_URL=redis://localhost:6379/0

# ============================================================================
# Temporal (Workflow orchestration)
# ============================================================================
TEMPORAL_HOST=localhost:7233
TEMPORAL_NAMESPACE=default
TEMPORAL_TASK_QUEUE=wisqu-local-queue
TEMPORAL_ENABLED=true

# ============================================================================
# Qdrant (Vector database)
# ============================================================================
QDRANT_URL=http://localhost:6333
QDRANT_API_KEY=
QDRANT_COLLECTION_NAME=islamic_knowledge
QDRANT_COLLECTION_PREFIX=local_

# ============================================================================
# Security (Generate: openssl rand -hex 32)
# ============================================================================
JWT_SECRET_KEY=your-secret-key-change-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# ============================================================================
# Google OAuth
# ============================================================================
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:8000/api/v1/auth/google/callback

# ============================================================================
# LLM Providers
# ============================================================================
# OpenAI
OPENAI_API_KEY=your-openai-api-key
OPENAI_ORG_ID=

# Google (shared with embeddings & ASR)
GOOGLE_API_KEY=your-google-api-key
GOOGLE_PROJECT_ID=your-google-project-id
GOOGLE_LOCATION=us-central1

# Cohere
COHERE_API_KEY=your-cohere-api-key

# OpenRouter (Recommended - Unified API for 100+ models)
OPENROUTER_API_KEY=sk-or-v1-...
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_APP_NAME=WisQu Islamic Chatbot
OPENROUTER_APP_URL=https://wisqu.com

# ============================================================================
# LLM Configuration
# ============================================================================
LLM_PROVIDER=openrouter
LLM_MODEL=anthropic/claude-3.5-sonnet
LLM_TEMPERATURE=0.7
LLM_MAX_TOKENS=4096

# ============================================================================
# Embeddings
# ============================================================================
EMBEDDING_PROVIDER=gemini
EMBEDDING_MODEL=gemini-embedding-001
EMBEDDING_DIMENSION=3072

# ============================================================================
# Reranker (2-stage retrieval: 20-40% quality boost)
# ============================================================================
RERANKER_ENABLED=true
RERANKER_PROVIDER=cohere
RERANKER_MODEL=rerank-3.5

# ============================================================================
# Web Search
# ============================================================================
WEB_SEARCH_ENABLED=true
WEB_SEARCH_PROVIDER=openrouter
WEB_SEARCH_MODEL=openai/gpt-4o-mini-search-preview
WEB_SEARCH_TEMPERATURE=0.3
WEB_SEARCH_MAX_TOKENS=4096
WEB_SEARCH_CONTEXT_SIZE=medium
WEB_SEARCH_ENGINE=
SERPER_API_KEY=

# ============================================================================
# OpenRouter Advanced
# ============================================================================
PROMPT_CACHING_ENABLED=true
CACHE_CONTROL_STRATEGY=auto
CACHE_MIN_TOKENS=1024
MODEL_ROUTING_ENABLED=true
DEFAULT_FALLBACK_MODELS=
ROUTING_STRATEGY=auto
ENABLE_AUTO_ROUTER=false
USAGE_TRACKING_ENABLED=true
TRACK_USER_IDS=true

# Image Generation
IMAGE_GENERATION_ENABLED=true
IMAGE_GENERATION_MODELS=["openai/gpt-5-image", "google/gemini-2.5-flash-image"]
IMAGE_STORAGE_TYPE=minio
IMAGE_MAX_SIZE_MB=10

# Structured Outputs & Multimodal
STRUCTURED_OUTPUTS_ENABLED=true
PDF_PROCESSING_ENABLED=true
AUDIO_PROCESSING_ENABLED=true
PDF_SKIP_PARSING=false

# ============================================================================
# AI Components
# ============================================================================
# Chonkie (Chunking)
CHUNKING_STRATEGY=semantic
CHUNK_SIZE=512
CHUNK_OVERLAP=50

# mem0 (Memory)
MEM0_ENABLED=true
MEM0_COMPRESSION_ENABLED=true

# NeMo Guardrails
GUARDRAILS_ENABLED=true
GUARDRAILS_LLM_PROVIDER=openrouter
GUARDRAILS_LLM_MODEL=openrouter/auto

# ============================================================================
# Logging & Observability
# ============================================================================
LOG_LEVEL=DEBUG
LOG_FORMAT=colored
LOG_TIMESTAMP=both
LOG_TIMESTAMP_PRECISION=6
LOG_COLOR=auto

# Langfuse (LLM observability - Cloud recommended)
LANGFUSE_ENABLED=true
LANGFUSE_PUBLIC_KEY=pk-lf-...
LANGFUSE_SECRET_KEY=sk-lf-...
LANGFUSE_HOST=https://cloud.langfuse.com

# ============================================================================
# Rate Limiting
# ============================================================================
RATE_LIMIT_ANONYMOUS=5
RATE_LIMIT_FREE=10
RATE_LIMIT_PREMIUM=50
RATE_LIMIT_UNLIMITED=1000
RATE_LIMIT_TEST=10000

# ============================================================================
# CORS
# ============================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:8000
CORS_ALLOW_CREDENTIALS=true

# ============================================================================
# External API
# ============================================================================
EXTERNAL_API_ENABLED=true
EXTERNAL_API_DEFAULT_RATE_LIMIT=100

# ============================================================================
# Tools
# ============================================================================
AHKAM_CACHE_TTL_HOURS=24
AHKAM_FETCH_TIMEOUT_SECONDS=30
AHKAM_MAX_RETRIES=3

# HuggingFace
HUGGINGFACE_TOKEN=
HUGGINGFACE_REPO_ID=

# ============================================================================
# Email (OTP & notifications)
# ============================================================================
EMAIL_PROVIDER=mailgun

# Mailgun (Production-ready)
MAILGUN_API_KEY=
MAILGUN_DOMAIN=
MAILGUN_FROM_EMAIL=noreply@wisqu.com
MAILGUN_FROM_NAME=WisQu Islamic Chatbot

# SMTP (Fallback)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@example.com
SMTP_FROM_NAME=WisQu Islamic Chatbot

# ============================================================================
# Super Admin (⚠️ Change after first login!)
# ============================================================================
SUPER_ADMIN_EMAIL=admin@wisqu.com
SUPER_ADMIN_PASSWORD=ChangeMe123!

# ============================================================================
# MinIO (S3-compatible object storage)
# ============================================================================
MINIO_ENABLED=true
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_SECURE=false
MINIO_REGION=us-east-1
MINIO_PUBLIC_URL=http://localhost:9000
MINIO_BUCKET_PREFIX=local-

# Buckets (auto-prefixed with environment)
MINIO_BUCKET_IMAGES=wisqu-images
MINIO_BUCKET_DOCUMENTS=wisqu-documents
MINIO_BUCKET_AUDIO_RESOURCES=wisqu-audio-resources
MINIO_BUCKET_AUDIO_USER=wisqu-audio-user
MINIO_BUCKET_AUDIO_TRANSCRIPTS=wisqu-audio-transcripts
MINIO_BUCKET_UPLOADS=wisqu-uploads
MINIO_BUCKET_TEMP=wisqu-temp
MINIO_BUCKET_BACKUPS=wisqu-backups

# ============================================================================
# Storage Limits
# ============================================================================
STORAGE_MAX_FILE_SIZE_MB=50
STORAGE_MAX_IMAGE_SIZE_MB=10
STORAGE_MAX_AUDIO_SIZE_MB=25
STORAGE_MAX_DOCUMENT_SIZE_MB=20

# User Quotas by Plan
STORAGE_QUOTA_FREE=100
STORAGE_QUOTA_PREMIUM=5120
STORAGE_QUOTA_UNLIMITED=51200

# ============================================================================
# ASR (Automatic Speech Recognition)
# ============================================================================
ASR_ENABLED=true
ASR_PROVIDER=google
ASR_LANGUAGE=fa-IR
ASR_ALTERNATIVE_LANGUAGES=ar-SA,en-US
ASR_MAX_AUDIO_DURATION_SECONDS=600
GOOGLE_ASR_CREDENTIALS_PATH=

# Gemini ASR (when ASR_PROVIDER=gemini)
GEMINI_ASR_MODEL=gemini-2.0-flash-exp

# ============================================================================
# Environment Auto-config
# ============================================================================
ENVIRONMENT_DATA_RETENTION_DAYS=30
ENVIRONMENT_ALLOW_TEST_ACCOUNTS=true
ENVIRONMENT_AUTO_CLEANUP_ENABLED=true
ENVIRONMENT_CLEANUP_SCHEDULE=0 2 * * *

# ============================================================================
# Promotion Settings
# ============================================================================
PROMOTION_ENABLED=true
PROMOTION_REQUIRE_APPROVAL=true
PROMOTION_ALLOWED_PATHS=dev->stage,stage->prod,dev->prod
PROMOTION_MAX_ITEMS_PER_BATCH=100
PROMOTION_ROLLBACK_WINDOW_HOURS=24
